# DB_Snapshot
## 概要
* テストエビデンス作成時にDB内容を取得し、エクセルファイルへ貼り付けている
* A5mk2で用意したSELECT文（複数）を同時に動かし、結果タブ１つ１つからコピペするのはなかなか手間である
* そこでSELECT文をスクリプト化し、実行結果をクリップボードへ入力することで、複数検索結果を簡単にエクセルへ貼り付けられるようにしてみた

## スクリプトの起動方法
```
sqlplus -S /@XE as sysdba @DB_SELECT.sql | clip
```

## 使い方
* 実行結果はクリップボードへ入力される
* EXCELは書式を文字列にしておけば、思いも寄らない変換もされない
* 罫線や着色は別途用意しておいて、まとめて書式貼り付けてしてやれば良い

## SQLファイルの弄り方
- 列名を取得する
  - A5mk2で次のようなSQLを実行し、A5mk2の「列名コピー」で取得する
    ```
    SELECT * FROM ALL_USERS;
    ```
- 以下２個所へ反映する、CHR(9)やシングルクォーテーションはタブコードを置換してやればよい、
  ```
  -- 列名
  SELECT 'USERNAME' || CHR(9) || 'USER_ID' FROM DUAL;

  -- 値
  SELECT USERNAME || CHR(9) || USER_ID
  FROM ALL_USERS;
  ```
- ファイルはSJISエンコードにしている。
